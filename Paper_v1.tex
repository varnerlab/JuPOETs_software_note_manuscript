%% BioMed_Central_Tex_Template_v1.06
%%                                      %
%  bmc_article.tex            ver: 1.06 %
%                                       %

%%IMPORTANT: do not delete the first line of this template
%%It must be present to enable the BMC Submission system to
%%recognise this template!!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                     %%
%%  LaTeX template for BioMed Central  %%
%%     journal article submissions     %%
%%                                     %%
%%          <8 June 2012>              %%
%%                                     %%
%%                                     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% For instructions on how to fill out this Tex template           %%
%% document please refer to Readme.html and the instructions for   %%
%% authors page on the biomed central website                      %%
%% http://www.biomedcentral.com/info/authors/                      %%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%% BioMed Central currently use the MikTex distribution of         %%
%% TeX for Windows) of TeX and LaTeX.  This is available from      %%
%% http://www.miktex.org                                           %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% additional documentclass options:
%  [doublespacing]
%  [linenumbers]   - put the line numbers on margins

%%% loading packages, author definitions

%\documentclass[twocolumn]{bmcart}% uncomment this for twocolumn layout and comment line below
\documentclass{bmcart}

%%% Load packages
\usepackage{amsthm,amsmath}
\usepackage{graphicx}
\usepackage[margin=0.1pt,font=footnotesize,labelfont=bf]{caption}

% Imports required for p-code of JuPOETs
\usepackage[linesnumbered]{algorithm2e}
%\usepackage{algorithm}
%\RequirePackage{natbib}
%\RequirePackage[authoryear]{natbib}% uncomment this for author-year bibliography
%\RequirePackage{hyperref}
\usepackage[utf8]{inputenc} %unicode support
%\usepackage[applemac]{inputenc} %applemac support if unicode package fails
%\usepackage[latin1]{inputenc} %UNIX support if unicode package fails


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                             %%
%%  If you wish to display your graphics for   %%
%%  your own use using includegraphic or       %%
%%  includegraphics, then comment out the      %%
%%  following two lines of code.               %%
%%  NB: These line *must* be included when     %%
%%  submitting to BMC.                         %%
%%  All figure files must be submitted as      %%
%%  separate graphics through the BMC          %%
%%  submission process, not included in the    %%
%%  submitted article.                         %%
%%                                             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\def\includegraphic{}
\def\includegraphics{}



%%% Put your definitions there:
\startlocaldefs
\endlocaldefs


%%% Begin ...
\begin{document}

%%% Start of article front matter
\begin{frontmatter}

\begin{fmbox}
\dochead{Software}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the title of your article here     %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{JuPOETs: A Constrained Multiobjective Optimization Approach to Estimate Biochemical Model Ensembles in the Julia Programming Language}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors here                   %%
%%                                          %%
%% Specify information, if available,       %%
%% in the form:                             %%
%%   <key>={<id1>,<id2>}                    %%
%%   <key>=                                 %%
%% Comment or delete the keys which are     %%
%% not used. Repeat \author command as much %%
%% as required.                             %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author[
   addressref={aff2},
   email={dmb457@cornell.edu}
]{\inits{DB}\fnm{David} \snm{Bassen}}
\author[
  addressref={aff1}
]{\inits{MV}\fnm{Michael} \snm{Vilkhovoy}}
\author[
  addressref={aff1}
]{\inits{MM}\fnm{Mason} \snm{Minot}}
\author[
   addressref={aff2},
   email={jtb47@cornell.edu}
]{\inits{JB}\fnm{Jonathan T} \snm{Butcher}}
\author[
   addressref={aff1},                   % id's of addresses, e.g. {aff1,aff2}
   corref={aff1},                       % id of corresponding address, if any
   %noteref={n1},                        % id's of article notes, if any
   email={jdv27@cornell.edu}   % email address
]{\inits{JV}\fnm{Jeffrey D} \snm{Varner}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors' addresses here        %%
%%                                          %%
%% Repeat \address commands as much as      %%
%% required.                                %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\address[id=aff1]{%                           % unique id
  \orgname{Department of Chemical and Biomolecular Engineering}, % university, etc
  \street{Cornell University},                     %
  \postcode{14806}                              % post or zip code
  \city{Ithaca NY},                             % city
  \cny{USA}                                    % country
}
\address[id=aff2]{%
  \orgname{Department of Biomedical Engineering},
  \street{Cornell University},                     %
  \postcode{14806}                              % post or zip code
  \city{Ithaca NY},                             % city
  \cny{USA}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter short notes here                   %%
%%                                          %%
%% Short notes will be after addresses      %%
%% on first page.                           %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{artnotes}
%\note{Sample of title note}     % note to the article
%\note[id=n1]{Equal contributor} % note, connected to author
\end{artnotes}

\end{fmbox}% comment this for two column layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Abstract begins here                 %%
%%                                          %%
%% Please refer to the Instructions for     %%
%% authors on http://www.biomedcentral.com  %%
%% and include the section headings         %%
%% accordingly for your article type.       %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstractbox}

\begin{abstract} % abstract
\parttitle{First part title} %if any
Text for this section.

\parttitle{Second part title} %if any
Text for this section.
\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The keywords begin here                  %%
%%                                          %%
%% Put each keyword in separate \kwd{}.     %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{keyword}
\kwd{sample}
\kwd{article}
\kwd{author}
\end{keyword}

% MSC classifications codes, if any
%\begin{keyword}[class=AMS]
%\kwd[Primary ]{}
%\kwd{}
%\kwd[; secondary ]{}
%\end{keyword}

\end{abstractbox}
%
%\end{fmbox}% uncomment this for twcolumn layout

\end{frontmatter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Main Body begins here                %%
%%                                          %%
%% Please refer to the instructions for     %%
%% authors on:                              %%
%% http://www.biomedcentral.com/info/authors%%
%% and include the section headings         %%
%% accordingly for your article type.       %%
%%                                          %%
%% See the Results and Discussion section   %%
%% for details on how to create sub-sections%%
%%                                          %%
%% use \cite{...} to cite references        %%
%%  \cite{koon} and                         %%
%%  \cite{oreg,khar,zvai,xjon,schn,pond}    %%
%%  \nocite{smith,marg,hunn,advi,koha,mouse}%%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%% start of article main body
% <put your article body there>

%%%%%%%%%%%%%%%%
%% Background %%
%%
\section*{Background}
Models of signal transduction networks may exhibit complex relationships between model performance and parameter values \cite{Brown:2004}.
It is often not possible to uniquely identify parameters from noisy experimental measurements, even when given extensive training data \cite{Gadkar:2005ad}.
Thus, despite significant advances in standardizing model identification \cite{Gennemark:2009on},
the core problem of estimating model parameters from noisy data remains.
Ensemble approaches have been used to address parameter uncertainty in systems biology and other fields like weather prediction \cite{Battogtokh:2002,Kuepfer:2007, Brown:2003,Palmer:2005}.
In an ensemble approach, a \emph{family} of approximate parameter sets is identified instead of a single best-fit parameter set.
Parameter families can be selected based on simulation error, along with other criterion such as diversity.
Simulations using parameter ensembles can estimate confidence intervals on model variables, and robustly constrain model predictions,
despite having many poorly constrained parameters \cite{Gutenkunst2007,Song:2009b}.
There are several techniques to generate parameter ensembles.
Battogtokh et al., Brown et al., and later Tasseff et al. generated experimentally constrained parameter ensembles using a
Metropolis-type random walk through parameter space \cite{Battogtokh:2002,Brown:2003,Tasseff:2010aa,Tasseff:2011aa}.
Other strategies could also be adapted to generate parameter ensembles \cite{Moles:2003}.
However, the unifying component of all of these previous strategies was the minimization of a single objective function.

Identification of large models with hundreds or even thousands of states and parameters may not be tractable as a single objective formulation.
Models at these scales require significant training data perhaps taken from diverse sources, for example different laboratories or cell-lines.
These diverse training data are likely heterogenous, and contain intrinsic conflicts.
On the other hand, large models can also be constructed from many smaller modules.
For example, Diamond and coworkers developed a model of phosphoinositide and calcium signaling in human platelets composed of many
separate submodels identified using different types of training data \cite{Purvis:2008}.
Taken together, the problem of identifying parameter ensembles for large-scale models with many parameters posses a unique challenge.
Parameter ensemble estimation techniques which optimally balance tradeoffs between submodels or conflicts in training data
might lead to more robust model performance. One class of such techniques is multiobjective optimization.
Previously, we developed the Pareto Optimal Ensemble Technique (POETs) algorithm to address the challenge of competing or conflicting objectives.
POETs, which integrates simulated annealing and multiobjective optimization through the notion of Pareto rank, finds a family of parameter estimates which optimally trade-off between
competing (and potentially conflicting) experimental objectives \cite{Song:2010aa}.
POETs has been used in several biochemical and signal transduction studies to estimate parameter ensembles \cite{Song:2009aa,Lequieu:2011aa}.
However, the previous implementation of POETs, in the Octave programming language \cite{Octave}, suffered from poor performance, and did not offer user definable
functions such as custom cooling schedules, parameter constraints, or custom search logic. It was also not well integrated into a modern package or
source code management (SCM) system.

\section*{Implementation}

In this study, we present JuPOETs, an open-source implementation of the Pareto Optimal Ensemble Technique (POETs) in the Julia programming language.
JuPOETs offers many advantages and improvements compared to the previous implementation of POETs.
First, JuPOETs takes advantage of the unique performance features of the Julia programming language.
Julia, which has performance comparable to C but with syntax similar to MATLAB/Octave and Python, is a cross-platform, high-performance programming language for technical computing \cite{Julia}. Julia offers a sophisticated compiler, distributed parallel execution, numerical accuracy, and an extensive mathematical function library.
Additionally, Julia offers a built-in package manager which is directly integrated with GitHub, a popular web-based Git repository hosting service which offers distributed revision control and source code management.
Next, because Julia can natively call other languages such as Python or C, JuPOETs can be used with models implemented in a variety of languages on many platforms.
Lastly, the architecture of JuPOETs takes advantage of the first-class function type in Julia allowing user definable behavior for all key aspects of the algorithm, including objective functions, custom search logic, linear/non-linear parameter constraints (and parameter bounds constraints) as well as custom cooling schedule functions. Thus, JuPOETs can easily be adapted to solve many problem types, including mixed binary and continuous variable types, without the need to change the base algorithm (which was not true of the previous POETs implementation).

\subsection*{Optimization problem formulation.}
JuPOETs solves the $\mathcal{K}-$dimensional constrained multiobjective optimization problem:
\begin{equation}
\min_{\mathbf{p}}
\begin{cases}
  O_{1}\left(\mathbf{x}(t,\mathbf{p}),\mathbf{p}\right) \\
  \vdots & \\
  O_{\mathcal{K}}\left(\mathbf{x}(t,\mathbf{p}),\mathbf{p}\right) \\
\end{cases}
\end{equation}
subject to:
\begin{eqnarray}\nonumber
  \mathbf{f}(t,\mathbf{x}(t,\mathbf{p}),\dot{\mathbf{x}}(t,\mathbf{p}),\mathbf{u}(t),\mathbf{p}) &=&\mathbf{0} \\\nonumber
  g_{1}\left(t,\mathbf{x}(t,\mathbf{p}),\mathbf{u}(t),\mathbf{p}\right) &\geq& 0 \\\nonumber
  &\vdots& \\\nonumber
  g_{\mathcal{C}}\left(t,\mathbf{x}(t,\mathbf{p}),\mathbf{u}(t),\mathbf{p}\right) &\geq& 0
\end{eqnarray}and parameter bound constraints:
\begin{equation}\nonumber
  \mathcal{L} \leq \mathbf{p} \leq \mathcal{U}
\end{equation}
The term t denotes time, $g_i\left(t,\mathbf{x}(t,\mathbf{p}),\mathbf{u}(t),\mathbf{p}\right)$ denotes the ith constraint on the search, where
$\mathbf{x}\left(t,\mathbf{p}\right)$ denotes the model state variable vector with an initial state $\mathbf{x}_{0}$, and $\mathbf{u}(t)$ is an input vector.
The terms $\mathbf{f}(t,\mathbf{x}(t,\mathbf{p}),\mathbf{u}(t),\mathbf{p})$ denote the system of model equations (e.g., differential equations,
differential algebraic equations or algebraic constraints) and $\mathbf{p}$ denotes the unknown parameter vector ($\mathcal{P}\times~1$).
The parameter search can be subject to parameter bound constraints where $\mathcal{L}$ and $\mathcal{U}$ denote the lower and upper parameter bounds, respectively.

POETs integrate Simulated Annealing (SA) with Pareto optimality to estimate parameter sets on or near the optimal tradeoff surface between competing training objectives
(Fig. \ref{fig:fig-MOSAalgorithm}).
The central idea underlying POETs is a mapping between the value of the objective functions evaluated at $\mathbf{p}_{i+1}$ (parameter guess at iteration $i+1$) and the Pareto rank.
Pareto rank is a measure of distance from the trade-off surface;
Parameter sets on or near the optimal trade-off surface between the objectives have a rank equal to $0$ (no other current parameter sets are better).
Sets with increasing non-zero rank are progressively further away from the optimal trade-off surface.
Thus, a parameter set with a $rank = 0$ is \emph{better} in a trade-off sense than $rank>0$.
We computed the Pareto rank of $\mathbf{p}_{i+1}$ by comparing the simulation error at iteration $i+1$ against an archive of simulation errors compiled up to iteration $i$ $\mathcal{O}_{i}$. We used the Fonseca and Fleming scheme to compute the Pareto rank, $r$ \cite{RANKING}:
\begin{equation}\label{eqn_rank}
rank\left(\mathbf{p}_{i+1}\mid \mathbf{E}_{i}\right)=r
\end{equation} where $r$ denotes the rank, or the number of parameter sets that dominate parameter set $\mathbf{p}_{i+1}$.
We used the Pareto rank to inform the SA calculation.
The parameter set $\mathbf{k}_{i+1}$ was accepted or rejected by the SA using the acceptance probability $\mathcal{P}\left(\mathbf{k}_{i+1}\right)$:
\begin{equation}\label{eqn_costMOSA}
\mathcal{P}(\mathbf{k}_{i+1}) \equiv \exp{\{-rank\left(\mathbf{k}_{i+1} \mid \mathbf{K}_{i} \right)/T\}}
\end{equation}
where $T$ is the computational annealing temperature. As $rank\left(\mathbf{k}_{i+1}\mid \mathbf{K}_{i}\right)\rightarrow{0}$, the acceptance probability moved toward one,
ensuring that we explored parameter sets along the Pareto surface.
Occasionally (depending upon $T$) a parameter set with a high Pareto rank was accepted by the SA allowing a more diverse search of the parameter space.
However, as $T$ was reduced, the probability of this occurring decreased.
Parameter sets could be accepted by the SA and $\emph{not}$ archived in $\mathbf{K}_{i}$.
Only parameter sets with rank less than or equal to a user defined threshold (rank$\leq$4 by default) were included in $\mathbf{K}_{i}$ to ensure that we characterized the neighborhood near the trade-off surface (Algorithm \ref{algo:JuPOETs-pcode}).

\begin{algorithm}[h!]

  \SetKwFunction{objective}{objective}
  \SetKwFunction{neighbor}{neighbor}
  \SetKwFunction{acceptance}{acceptance}
  \SetKwFunction{rank}{rank}

  \SetKwInOut{Input}{input}
  \SetKwInOut{Output}{Output}

  \Input{User specified neighbor, objective, acceptance and cooling functions. Initial parameter guess ($\mathcal{P}\times~1$)}
  \Output{Rank archive $\mathcal{R}$, solution archive $\mathcal{S}$ and objective archive $\mathcal{O}$}

  \BlankLine
  \BlankLine
  initialize: $\mathcal{R}$, $\mathcal{S}$ and $\mathcal{O}$ using initial guess\;
  initialize: T $\leftarrow$1.0\;
  initialize: $T_{min}\leftarrow$1/10000\;
  initialize: Maximum number of steps per temperature $\mathcal{I}$\;

  \BlankLine
  \BlankLine
 \While{$T>T_{min}$}{
    i $\leftarrow$  1\;
    \While{i$<\mathcal{I}$}{
      \BlankLine
      \BlankLine
      \tcp{Generate a new parameter solution using user neighbor function}
      $\mathbf{p}_{i+1}$ $\leftarrow$ user-function::\neighbor{$\mathbf{p}^{*}$}\;
      \BlankLine
      \BlankLine
      \tcp{Evaluate $\mathbf{p}_{i+1}$ using user objective function}
      $\mathbf{o}_{i+1}$ $\leftarrow$ user-function::\objective{$\mathbf{p}_{i+1}$}\;
      \BlankLine
      \BlankLine
      Add $\mathbf{p}_{i+1}$ to solution archive $\mathcal{S}$\;
      Add $\mathbf{o}_{i+1}$ to objective archive $\mathcal{O}$\;
      \BlankLine
      \BlankLine
      \tcp{Calculate Pareto rank of solutions in $\mathcal{O}$ using builtin rank function}
      $\mathcal{R}\leftarrow$ builtin-function::\rank{$\mathcal{O}$}\;

      \BlankLine
      \tcp{Accept $\mathbf{p}_{i+1}$ into the archive with user defined probability}
      $\mathcal{P}$ $\leftarrow$ user-function::\acceptance{$\mathcal{R}$,$T$}\;
      \eIf {$\mathcal{P}>$rand}{

          \BlankLine
          \tcp{Update the best solution with $\mathbf{p}_{i+1}$}
          $\mathbf{p}^{*}$ $\leftarrow$ $\mathbf{p}_{i+1}$\;
          prune $\mathcal{S}$, $\mathcal{R}$ and $\mathcal{O}$ of all solutions above a rank threshold\;
      }{
        Remove $\mathbf{p}_{i+1}$ from solution archive $\mathcal{S}$\;
        Remove $\mathbf{o}_{i+1}$ from error archive $\mathcal{O}$\;
      }

      \BlankLine
      i $\leftarrow$  i + 1\;
    }

    \BlankLine
    \tcp{Update $T$ using the user cooling function}
    $T$ $\leftarrow$ user-function::cooling($T$)\;
 }
\vspace{0.05in}
\caption{Pseudo-code for the run-loop of the JuPOETs algorithm. The user specifies the neighbor, acceptance, cooling and objective function pointers along with a initial parameter guess.
The rank archive $\mathcal{R}$, solution archive $\mathcal{S}$ and objective archive $\mathcal{O}$ are initialized from the initial guess.
The initial guess is then perturbed in the neighbor function, which generates a new solution whose performance is evaluated using the user supplied objective function.
The new solution and objective values are then added to the respective archives and ranked using the builtin rank function.
If the new solution accepted (based upon a probability calculated with the user supplied acceptance function) it is added to the solution and objective archive. This solution is then perturbed during the next iteration of the algorithm.
However, if the solution is not accepted, it is removed from the archive and discarded. The computational temperature is adjusted using the user supplied cooling function after each $\mathcal{I}$ iterations. }\label{algo:JuPOETs-pcode}
\end{algorithm}

\clearpage

\section*{Results and Discussion}

JuPOETs identified solutions on or near the optimal tradeoff surface significantly faster than Octave-POETs for the suite of test problems
(Fig. \ref{fig:fig-timing} and Fig. \ref{fig:fig-surfaces}).
We compared the performance of JuPOETs versus POETs implemented in Octave for a suite of multiobjective test functions (Table \ref{table:objective-table}).
The wall-clock time for JuPOETs and Octave-POETs was measured for 10 independent trials for the test problems.
The same cooling, neighbor, acceptance, search and objective logic was employed between the implementations, and all other parameters were held constant.
For each test function, the search domain was partitioned into 10 segments, where an initial parameter guess was drawn from each partition.
The number of search steps for each temperate $\mathcal{I}$ = 10 for all cases, and the cooling parameter was $\alpha$ = 0.9.
On average, JuPOETs identified optimal or near optimal solutions for the suite of test problems six-fold faster (60s versus 400s)
than Octave-POETs (Fig. \ref{fig:fig-timing}). In addition, JuPOETs produced the characteristic tradeoff curves for each test problem, given both parameter bound and
problem constraints (Fig. \ref{fig:fig-surfaces}). Taken together, these results suggested that JuPOETs was able to estimate an ensemble of solutions to constrained multiobjective optimization problems significantly faster than the current Octave implementation.
Next, we tested JuPOETs on a proof-of-concept biochemical model identification problem.

JuPOETs estimated an ensemble of biochemical models that was consistent with the mean of synthetic training data (Fig. \ref{fig:fig-biochemical}).
Four synthetic data sets were generated from a prototypical biochemical network consisting of 6 metabolites and 7 reactions (Fig. \ref{fig:fig-biochemical}, inset right).
We considered a typical case in which the same measurements were made on four different hypothetical cell types, each having the same biological connectivity but different performance.
Network dynamics were modeled using the hybrid cybernetic model with elementary modes (HCM-EM) approach of Ramkrishna and coworkers \cite{2008_kim_varner_ramkrishna_BiotechProg}.
In the HCM-EM approach, metabolic networks are first decomposed into a set of elementary modes (EMs) (chemically balanced steady-state pathways, see \cite{Schuster:2000aa}).
Combinations of elementary modes are then used to characterize network behavior.
Each elementary mode is catalyzed by a pseudo enzyme; thus, each mode has both kinetic and enzyme synthesis parameters.
The proof of concept network generated 6 EMs, resulting in 13 model parameters.
The synthetic data was generated by randomly varying these parameters.
JuPOETs produced an ensemble of models that captured the mean of the measured data sets for extracellular metabolites and cellmass
(Fig. \ref{fig:fig-biochemical}A and B). The 95\% confidence estimate produced by the ensemble was consistent with mean of the measured data, despite having significant uncertainty in the data. 



\section*{Conclusions}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Backmatter begins here                   %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{backmatter}

\section*{Competing interests}
  The authors declare that they have no competing interests.

\section*{Funding}
This study was supported by an award from the National Science Foundation (NSF CBET-0955172) and the National Institutes of Health (NIH HL110328) to J.B, and by
a National Science Foundation Graduate Research Fellowship (NSGRF) to D.B.

\section*{Author's contributions}
    J.V developed the software presented in this study. M.M and M.V developed the proof-of-concept biochemical model.
    The manuscript was prepared and edited for publication by D.B, J.B. and J.V.

%\section*{Acknowledgements}
%  Text for this section \ldots
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                  The Bibliography                       %%
%%                                                         %%
%%  Bmc_mathpys.bst  will be used to                       %%
%%  create a .BBL file for submission.                     %%
%%  After submission of the .TEX file,                     %%
%%  you will be prompted to submit your .BBL file.         %%
%%                                                         %%
%%                                                         %%
%%  Note that the displayed Bibliography will not          %%
%%  necessarily be rendered by Latex exactly as specified  %%
%%  in the online Instructions for Authors.                %%
%%                                                         %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% if your bibliography is in bibtex format, use those commands:
\bibliographystyle{bmc-mathphys} % Style BST file (bmc-mathphys, vancouver, spbasic).
\bibliography{References_v1}      % Bibliography file (usually '*.bib' )
% for author-year bibliography (bmc-mathphys or spbasic)
% a) write to bib file (bmc-mathphys only)
% @settings{label, options="nameyear"}
% b) uncomment next line
%\nocite{label}

% or include bibliography directly:
% \begin{thebibliography}
% \bibitem{b1}
% \end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Figures                       %%
%%                               %%
%% NB: this is for captions and  %%
%% Titles. All graphics must be  %%
%% submitted separately and NOT  %%
%% included in the Tex document  %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%
%% Do not use \listoffigures as most will included as separate files

\clearpage

\section*{Figures}

\begin{figure}[h]
  \caption{Schematic of multiobjective parameter mapping. The performance of any given parameter set is mapped into an objective space using a ranking function which quantifies the quality of the parameters. The distance away from the optimal tradeoff surface is quantified using the Pareto ranking scheme of Fonseca and Fleming in JuPOETs.}\label{fig:fig-MOSAalgorithm}
\end{figure}

\begin{figure}[h]
  \caption{The performance of JuPOETs on the multi-objective test suite.
  The execution time (wall-clock) for JuPOETs and POETs implemented in Octave was measured for 10 independent trials for the suite of test problems.
  The number of steps per temperature $\mathcal{I}$ = 10, and the cooling parameter $\alpha$ = 0.9 for all cases.
  The problem domain was partitioned into 10 equal segments, an initial guess was drawn from each segment.
  For each of the test functions, JuPOETs estimated solutions on (rank zero solutions, black) or near (gray) the optimal tradeoff surface, subject to bounds and problem constraints.  }\label{fig:fig-timing}
\end{figure}

\begin{figure}[h]
  \caption{Representative JuPOETs solutions for problems in the multi-objective test suite.
  The number of steps per temperature $\mathcal{I}$ = 10, and the cooling parameter $\alpha$ = 0.9 for all cases.
  The problem domain was partitioned into 10 equal segments, an initial guess was drawn from each segment.
  For each of the test functions, JuPOETs estimated solutions on (rank zero solutions, black) or near (gray) the optimal tradeoff surface, subject to bounds and problem constraints.  }\label{fig:fig-surfaces}
\end{figure}

\begin{figure}[h]
  \caption{Proof of concept biochemical network study.
  Inset: Prototypical biochemical network with six metabolites and seven reactions modeled using the hybrid cybernetic approach (HCM).
  Intracellular cellmass precursors $A,B$, and $C$ are balanced (no accumulation) while the extracellular metabolites $A_{e},B_{e}$, and $C_{e}$ are dynamic.
  The oval denotes the cell boundary, $q_{j}$ is the $j$th flux across the boundary, and $v_{k}$ denotes the $k$th intracellular flux.
  Four data sets (each with $A_{e},B_{e}$,$C_{e}$ and cellmass measurements) were generated by varying the kinetic constant for each biochemical modes.
  Each data set was a single objective.
  A: Ensemble simulation of extracellular substrate $A_{e}$ and cellmass versus time.
  B: Ensemble simulation of extracellular substrate $B_{e}$ and $C_{e}$ versus time.
  The gray region denotes the 95\% confidence estimate of the mean ensemble simulation.
  The data points denote mean synthetic measurements, while the error bars denote the 95\% confidence estimate of the measurement computed over the four training data sets.
  C: Trade-off plots between the four training objectives. The quantity $O_{j}$ denotes the jth training objective.
  Each point represents a member of the parameter ensemble, where gray denotes rank 0 sets, while black denotes rank 1 sets.
   }\label{fig:fig-biochemical}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Tables                        %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Use of \listoftables is discouraged.
%%
\clearpage
\section*{Tables}

\begin{table}
  \caption{Multi-objective optimization test problems. We tested the JuPOETs implementation on three two-dimensional test problems, with one-, two- and three-dimensional parameter vectors.
  Each problem had parameter bounds constraints, however, on the Binh and Korn function had additional non-linear problem constraints. For the Fonesca and Fleming problem, N = 3.}
  \label{table:objective-table}
\end{table}

% \begin{table}[h!]
% \caption{Sample table title. This is where the description of the table should go.}
%       \begin{tabular}{cccc}
%         \hline
%            & B1  &B2   & B3\\ \hline
%         A1 & 0.1 & 0.2 & 0.3\\
%         A2 & ... & ..  & .\\
%         A3 & ..  & .   & .\\ \hline
%       \end{tabular}
% \end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Additional Files              %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \section*{Additional Files}
%   \subsection*{Additional file 1 --- Sample additional file title}
%     Additional file descriptions text (including details of how to
%     view the file, if it is in a non-standard format or the file extension).  This might
%     refer to a multi-page table or a figure.
%
%   \subsection*{Additional file 2 --- Sample additional file title}
%     Additional file descriptions text.

\end{backmatter}
\end{document}
